{"version":3,"file":"telegram.min.js","sources":["../src/telegram.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\nimport $ from 'jquery';\n\n/**\n * Telegram authentication widget\n *\n * @module     auth_telegram/telegram\n * @copyright  2025 Wail Abualela\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * Validates the required parameters.\n * @param {string} botusername - The Telegram bot username\n * @param {string} wwwroot - The Moodle root URL\n * @return {boolean} True if parameters are valid, false otherwise\n */\nconst validateParameters = (botusername, wwwroot) => {\n    if (!botusername || botusername.trim() === '') {\n        return false;\n    }\n\n    if (!wwwroot || wwwroot.trim() === '') {\n        return false;\n    }\n\n    return true;\n};\n\n/**\n * Creates and adds the Telegram widget script to the document.\n * @param {string} botusername - The Telegram bot username\n * @param {string} wwwroot - The Moodle root URL\n * @return {Object} The created script element\n */\nconst createTelegramWidgetScript = (botusername, wwwroot) => {\n    const script = $(\"<script>\").attr({\n        \"async\": true,\n        \"src\": \"https://telegram.org/js/telegram-widget.js?21\",// Updated to latest version\n        \"data-telegram-login\": botusername,\n        \"data-size\": \"large\",\n        \"data-radius\": \"5\",\n        \"data-auth-url\": wwwroot + \"/auth/telegram/index.php\",\n        \"data-request-access\": \"write\"\n    });\n    return script;\n};\n\n\n/**\n * Creates a container for identity provider buttons styled for the Telegram authentication method.\n * The container is a div element with specific Bootstrap classes and custom styling.\n * @return {jQuery} A jQuery object representing a div element styled as a button\n *                  with appropriate classes and custom background color for Telegram.\n */\nconst createIdentityProvidersContainer = () => {\n    return $('<div>')\n        .addClass('btn btn-secondary login-identityprovider-btn rui-potentialidp w-100 mt-1')\n        .css({\n            'background-color': '#54a9eb'\n        });\n};\n\n/**\n * Initialize the Telegram authentication widget.\n *\n * @param {string} botusername - The Telegram bot username\n * @param {string} wwwroot - The Moodle root URL\n */\nexport const init = (botusername, wwwroot) => {\n    // Validate required parameters\n    if (!validateParameters(botusername, wwwroot)) {\n        return;\n    }\n\n    // Find the identity providers container\n    const identityproviders = $('.login-identityproviders');\n    if (identityproviders.length === 0) {\n        return;\n    }\n    identityproviders.append(\n        createIdentityProvidersContainer().append(\n            createTelegramWidgetScript(botusername, wwwroot)\n        )\n    );\n};"],"names":["botusername","wwwroot","trim","validateParameters","identityproviders","length","append","addClass","css","attr","createTelegramWidgetScript"],"mappings":";;;;;;;wJAmFoB,CAACA,YAAaC,eApDP,EAACD,YAAaC,aAChCD,aAAsC,KAAvBA,YAAYE,SAI3BD,SAA8B,KAAnBA,QAAQC,QAiDnBC,CAAmBH,YAAaC,sBAK/BG,mBAAoB,mBAAE,4BACK,IAA7BA,kBAAkBC,QAGtBD,kBAAkBE,QAxBX,mBAAE,SACJC,SAAS,4EACTC,IAAI,oBACmB,YAsBWF,OA9CR,EAACN,YAAaC,WAC9B,mBAAE,YAAYQ,KAAK,QACrB,MACF,sEACgBT,wBACV,sBACE,oBACEC,QAAU,iDACJ,UAuCnBS,CAA2BV,YAAaC"}